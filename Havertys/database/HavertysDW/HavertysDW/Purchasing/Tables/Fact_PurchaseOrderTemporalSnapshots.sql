CREATE TABLE [Purchasing].[Fact_PurchaseOrderTemporalSnapshots] (
    [Purchase_Order_sk]             INT             IDENTITY (1, 1) NOT NULL,
    [Ordered_Quantity]              INT             NULL,
    [Received_Quantity]             INT             NULL,
    [Canceled_Quantity]             INT             NULL,
    [Merchandising_Unit_Cost]       DECIMAL (7, 2)  NULL,
    [Ordered_Cost]                  DECIMAL (11, 2) NULL,
    [Received_Cost]                 DECIMAL (11, 2) NULL,
    [Canceled_Cost]                 DECIMAL (11, 2) NULL,
    [Purchase_Order_Total_Cost]     DECIMAL (11, 2) NULL,
    [PO_Create_Date_fk]             INT             NOT NULL,
    [Transmitted_Date_fk]           INT             NOT NULL,
    [Acknowledge_Date_fk]           INT             NOT NULL,
    [Drop_Date_fk]                  INT             NOT NULL,
    [Estimated_Ship_Date_fk]        INT             NOT NULL,
    [Origin_Port_Departure_Date_fk] INT             NOT NULL,
    [US_Port_Arrival_Date_fk]       INT             NOT NULL,
    [Depot_Arrival_Date_fk]         INT             NOT NULL,
    [Arrive_Date_fk]                INT             NOT NULL,
    [Cancel_Date_fk]                INT             NOT NULL,
    [Changed_Date_fk]               INT             NOT NULL,
    [Location_fk]                   INT             NOT NULL,
    [SKU_fk]                        INT             NOT NULL,
    [SKU_History_fk]                INT             NOT NULL,
    [Shipper_fk]                    INT             NOT NULL,
    [Shipping_Origin_fk]            INT             NOT NULL,
    [Employee_Entered_fk]           INT             NOT NULL,
    [Transaction_Link_fk]           INT             NOT NULL,
    [PO_Number_nk]                  INT             NULL,
    [PO_Line_Number_nk]             SMALLINT        NULL,
    [Division_nk]                   INT             NULL,
    [Market_nk]                     INT             NULL,
    [PO_Origin_Type]                VARCHAR (50)    NULL,
    [Master_PO_Flag]                VARCHAR (1)     NULL,
    [Master_PO_Number]              INT             NULL,
    [PO_Status_Code]                VARCHAR (2)     NULL,
    [PO_Status]                     VARCHAR (50)    NULL,
    [PO_Line_Status_Code]           CHAR (2)        NULL,
    [PO_Line_Status]                VARCHAR (50)    NULL,
    [Merchandising_Class_Code]      NUMERIC (3)     NULL,
    [Merchandising_Class]           VARCHAR (50)    NULL,
    [IC_Priority_Code]              SMALLINT        NULL,
    [IC_Priority]                   VARCHAR (50)    NULL,
    [Autogenerated_Flag]            VARCHAR (10)    NULL,
    [Accessories_Flag]              VARCHAR (1)     NULL,
    [Special_Order_Flag]            VARCHAR (1)     NULL,
    [Acknowledge_Number]            VARCHAR (14)    NULL,
    [Acknowledge_Status_Code]       SMALLINT        NULL,
    [Acknowledge_Status]            VARCHAR (50)    NULL,
    [EDI_Flag]                      VARCHAR (1)     NULL,
    [Ship_Complete_Flag]            VARCHAR (1)     NULL,
    [Electronic_Flag]               VARCHAR (1)     NULL,
    [Processed_Through_EDI_Flag]    VARCHAR (1)     NULL,
    [Freight_Free_Flag]             VARCHAR (1)     NULL,
    [Corporate_Acc_PO_FLAG]         VARCHAR (1)     NULL,
    [JIT_Flag]                      VARCHAR (1)     NULL,
    [Forecast_PO_Flag]              VARCHAR (1)     NULL,
    [Direct_Paid_After_Receipt]     VARCHAR (1)     NULL,
    [Key_Hash]                      CHAR (64)       NOT NULL,
    [Row_Value_Hash]                CHAR (64)       NOT NULL,
    [Snapshot_StartDate]            DATETIME        NOT NULL,
    [Snapshot_EndDate]              DATETIME        NOT NULL,
    [Snapshot_Current_Flag]         BIT             NOT NULL,
    [SourceSystem_fk]               INT             NOT NULL,
    [ETLBatchID_Insert]             INT             NOT NULL,
    [ETLBatchID_Update]             INT             NOT NULL,
    CONSTRAINT [PK_Purchase_Order_sk] PRIMARY KEY NONCLUSTERED ([Purchase_Order_sk] ASC),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Acknowledge] FOREIGN KEY ([Acknowledge_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Arrive] FOREIGN KEY ([Arrive_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Cancel] FOREIGN KEY ([Cancel_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Changed] FOREIGN KEY ([Changed_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Depot_Arrival] FOREIGN KEY ([Depot_Arrival_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Drop] FOREIGN KEY ([Drop_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Estimated_Ship] FOREIGN KEY ([Estimated_Ship_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Origin_Port_Departure] FOREIGN KEY ([Origin_Port_Departure_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_PO_Create] FOREIGN KEY ([PO_Create_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_Transmitted] FOREIGN KEY ([Transmitted_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Date_US_Port_Arrival] FOREIGN KEY ([US_Port_Arrival_Date_fk]) REFERENCES [DW].[Dim_Date] ([Date_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Employee] FOREIGN KEY ([Employee_Entered_fk]) REFERENCES [DW].[Dim_Employee] ([Employee_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Location] FOREIGN KEY ([Location_fk]) REFERENCES [DW].[Dim_Location] ([Location_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_Shipper] FOREIGN KEY ([Shipper_fk]) REFERENCES [DW].[Dim_Vendor] ([Vendor_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_ShippingOrigin] FOREIGN KEY ([Shipping_Origin_fk]) REFERENCES [DW].[Dim_ShippingOrigin] ([Shipping_Origin_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_SKU] FOREIGN KEY ([SKU_fk]) REFERENCES [DW].[Dim_SKU] ([SKU_sk]),
    CONSTRAINT [FK_Fact_PurchaseOrderTemporalSnapshots_Dim_SKU_History] FOREIGN KEY ([SKU_History_fk]) REFERENCES [DW].[Dim_SKU_History] ([SKU_History_sk])
);

